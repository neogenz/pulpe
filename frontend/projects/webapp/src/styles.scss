// Custom Theming for Angular Material
// For more information: https://material.angular.io/guide/theming
@use "@angular/material" as mat;
@use "sass:meta";
@use "./variables";
@use "./app/styles/themes/_theme-colors.scss" as theme;

// Local font faces (self-hosted via @fontsource, no runtime Google Fonts dependency)
@include meta.load-css("@fontsource/dm-sans/latin-400.css");
@include meta.load-css("@fontsource/dm-sans/latin-500.css");
@include meta.load-css("@fontsource/dm-sans/latin-600.css");
@include meta.load-css("@fontsource/dm-sans/latin-700.css");
@include meta.load-css("@fontsource/manrope/latin-500.css");
@include meta.load-css("@fontsource/manrope/latin-600.css");
@include meta.load-css("@fontsource/manrope/latin-700.css");
@include meta.load-css("@fontsource/manrope/latin-800.css");

// Product Tour
@import "driver.js/dist/driver.css";
@import "./app/core/product-tour/product-tour.css";

html {
  color-scheme: light dark;
  @include mat.theme(
    (
      color: (
        primary: theme.$primary-palette,
        tertiary: theme.$tertiary-palette,
      ),
      // typography: Roboto,
      typography: (
          plain-family: #{meta.inspect(variables.$regular-font-family)},
          brand-family: #{meta.inspect(variables.$heading-font-family)},
        ),
      density: 0,
    )
  );
}

html {
  width: 100%;
  // Desktop: prevent document scroll (content scrolls inside mat-sidenav-content)
  @media (min-width: 600px) {
    overflow: hidden;
  }
  // Mobile: no overflow set â†’ body's overflow propagates to viewport (per CSS spec)
}

body {
  margin: 0;
  overflow-x: hidden;
  max-width: 100vw;
  // Mobile: body-level scroll enables iOS Safari toolbar translucency
  // and Android Chrome/Samsung/Firefox navbar auto-hide
  @media (min-width: 600px) {
    height: 100%;
    overflow-y: hidden;
  }
  font-family:
    var(--mat-sys-typescale-body-medium-font-family-name), "DM Sans",
    "Helvetica Neue", sans-serif;
  background: var(--mat-sys-surface);
  color: var(--mat-sys-on-surface);
  font-size: var(--mat-sys-typescale-body-medium-size);
  line-height: var(--mat-sys-typescale-body-medium-line-height);
}

// Pulpe design tokens + brand gradient
:root {
  /* Layout */
  --pulpe-page-gutter-mobile: 16px;
  --pulpe-page-gutter-tablet: 24px;
  --pulpe-page-gutter-desktop: 32px;
  --pulpe-section-gap-sm: 16px;
  --pulpe-section-gap-md: 24px;
  --pulpe-section-gap-lg: 32px;

  /* Surfaces */
  --pulpe-surface-radius-card: 24px;
  --pulpe-surface-radius-panel: 16px;
  --pulpe-surface-border-subtle: 1px solid var(--mat-sys-outline-variant);

  /* Motion */
  --pulpe-motion-fast: 150ms;
  --pulpe-motion-base: 220ms;
  --pulpe-motion-slow: 320ms;
  --pulpe-ease-standard: cubic-bezier(0.2, 0, 0, 1);
  --pulpe-ease-emphasized: cubic-bezier(0.22, 1, 0.36, 1);

  /* Gradient */
  --pulpe-gradient-start: #009bff;
  --pulpe-gradient-mid1: #00edab;
  --pulpe-gradient-mid2: #30e868;
  --pulpe-gradient-end: #8fff6b;
}

@media (prefers-color-scheme: dark) {
  :root {
    --pulpe-gradient-start: #003d7a;
    --pulpe-gradient-mid1: #006b4e;
    --pulpe-gradient-mid2: #0d7a30;
    --pulpe-gradient-end: #2ba84a;
  }
}

.dark-theme {
  --pulpe-gradient-start: #003d7a;
  --pulpe-gradient-mid1: #006b4e;
  --pulpe-gradient-mid2: #0d7a30;
  --pulpe-gradient-end: #2ba84a;
}

.pulpe-gradient {
  background: linear-gradient(
    135deg,
    var(--pulpe-gradient-start) 0%,
    var(--pulpe-gradient-mid1) 33%,
    var(--pulpe-gradient-mid2) 66%,
    var(--pulpe-gradient-end) 100%
  );
}

.pulpe-entry-shell {
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: var(--pulpe-page-gutter-mobile);

  @media (min-width: 768px) {
    padding: var(--pulpe-page-gutter-tablet);
  }

  @media (min-width: 1280px) {
    padding: var(--pulpe-page-gutter-desktop);
  }
}

.pulpe-entry-card {
  width: 100%;
  border: var(--pulpe-surface-border-subtle);
  border-radius: var(--pulpe-surface-radius-card);
  padding: clamp(1.5rem, 2vw, 2.5rem);
  box-shadow: var(--mat-sys-level2);
  background: var(--mat-sys-surface);
  display: flex;
  flex-direction: column;
}

.pulpe-page-header {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  align-items: center;
  gap: var(--pulpe-section-gap-sm);
  margin-bottom: var(--pulpe-section-gap-sm);
}

// Budget section group - Material expansion panel overrides
// Scoped via host class to avoid ViewEncapsulation issues
.pulpe-budget-section-group {
  .mat-expansion-panel-body {
    padding: 0 !important;
  }

  .mat-expansion-panel-header {
    padding: 0 16px !important;
  }
}

// Side sheet dialog panel - slides from right edge
.side-sheet-panel {
  position: fixed !important;
  right: 0 !important;
  top: env(safe-area-inset-top) !important;
  margin: 0 !important;
  max-height: calc(
    100vh - env(safe-area-inset-top) - env(safe-area-inset-bottom)
  ) !important;
  border-radius: 0 !important;

  .mat-mdc-dialog-container,
  .mat-mdc-dialog-surface {
    border-radius: 16px 0 0 16px !important;
  }

  animation: pulpe-slide-in-right var(--pulpe-motion-slow)
    var(--pulpe-ease-standard);
}

// Keyframes - declared at root level with pulpe- prefix to avoid collisions
@keyframes pulpe-slide-in-right {
  from {
    transform: translateX(100%);
  }
  to {
    transform: translateX(0);
  }
}
