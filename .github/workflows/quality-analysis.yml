name: ğŸ“Š Quality Analysis

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

# TEMPORARILY DISABLED - uncomment when fixed
# Workflow disabled until we fix the environment issues
jobs:
  disabled:
    name: ğŸš« Quality Analysis Temporarily Disabled
    runs-on: ubuntu-latest
    if: false # This disables the entire workflow
    steps:
      - name: ğŸ“ Disabled Notice
        run: |
          echo "Quality analysis workflow is temporarily disabled"
          echo "Re-enable by removing 'if: false' condition"

  # bundle-analysis:
  #   name: ğŸ“¦ Bundle Analysis
  #   runs-on: ubuntu-latest
  #   if: github.event_name == 'pull_request'
  #   steps:
  #     - name: ğŸ“¦ Checkout
  #       uses: actions/checkout@v4

  #     - name: ğŸ“¦ Setup pnpm
  #       uses: pnpm/action-setup@v4
  #       with:
  #         version: 10.12.1

  #     - name: ğŸ“¦ Setup Node.js
  #       uses: actions/setup-node@v4
  #       with:
  #         node-version: "22"
  #         cache: "pnpm"

  #     - name: ğŸ“¦ Install dependencies
  #       run: pnpm install --frozen-lockfile

  #     - name: ğŸ”¨ Build shared packages
  #       run: pnpm run build:shared

  #     - name: ğŸ”¨ Build frontend with stats
  #       run: |
  #         cd frontend
  #         pnpm run ng build -- --stats-json --output-hashing=none --named-chunks

  #     - name: ğŸ“Š Archive bundle stats
  #       uses: actions/upload-artifact@v4
  #       with:
  #         name: bundle-stats
  #         path: frontend/dist/webapp/stats.json
  #         retention-days: 7

  # dependency-analysis:
  #   name: ğŸ” Dependency Analysis
  #   runs-on: ubuntu-latest
  #   steps:
  #     - name: ğŸ“¦ Checkout
  #       uses: actions/checkout@v4

  #     - name: ğŸ“¦ Setup pnpm
  #       uses: pnpm/action-setup@v4
  #       with:
  #         version: 10.12.1

  #     - name: ğŸ“¦ Setup Node.js
  #       uses: actions/setup-node@v4
  #       with:
  #         node-version: "22"
  #         cache: "pnpm"

  #     - name: ğŸ“¦ Install dependencies
  #       run: pnpm install --frozen-lockfile

  #     - name: ğŸ” Create deps directory
  #       run: mkdir -p frontend/deps/webapp

  #     - name: ğŸ” Analyze dependencies
  #       run: |
  #         cd frontend
  #         npx madge projects/webapp/src/main.ts --ts-config projects/webapp/tsconfig.app.json --image ./deps/webapp/dependencies.png --circular

  #     - name: ğŸ“Š Upload dependency graph
  #       uses: actions/upload-artifact@v4
  #       with:
  #         name: dependency-graph
  #         path: frontend/deps/
  #         retention-days: 7

  # coverage-report:
  #   name: ğŸ“Š Coverage Report
  #   runs-on: ubuntu-latest
  #   steps:
  #     - name: ğŸ“¦ Checkout
  #       uses: actions/checkout@v4

  #     - name: ğŸ“¦ Setup Bun
  #       uses: oven-sh/setup-bun@v2
  #       with:
  #         bun-version: latest

  #     - name: ğŸ“¦ Setup pnpm
  #       uses: pnpm/action-setup@v4
  #       with:
  #         version: 10.12.1

  #     - name: ğŸ“¦ Setup Node.js
  #       uses: actions/setup-node@v4
  #       with:
  #         node-version: "22"
  #         cache: "pnpm"

  #     - name: ğŸ“¦ Install dependencies
  #       run: pnpm install --frozen-lockfile

  #     - name: ğŸ”¨ Build shared packages
  #       run: pnpm run build:shared

  #     - name: ğŸ§ª Run frontend tests
  #       run: |
  #         cd frontend
  #         pnpm run test:vitest:run

  #     - name: ğŸ§ª Run backend tests with coverage
  #       run: |
  #         cd backend-nest
  #         bun run test:coverage

  #     - name: ğŸ“Š Archive coverage reports
  #       uses: actions/upload-artifact@v4
  #       with:
  #         name: coverage-reports
  #         path: |
  #           ./frontend/coverage/
  #           ./backend-nest/coverage/
  #         retention-days: 14
